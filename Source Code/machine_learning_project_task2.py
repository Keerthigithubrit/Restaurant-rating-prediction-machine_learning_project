# -*- coding: utf-8 -*-
"""Machine_Learning Project_Task2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1qKaUUkYp-QCJ1UJ0j1x3Ylp4-szcsM3d

# **TASK 2: Restaurant Recommendation System**

### **1. Introduction**

With the rapid growth of online food platforms, recommending suitable restaurants to users has become essential. A Restaurant Recommendation System helps users discover restaurants based on their preferences such as cuisine type, price range, and ratings.

This project implements a content-based recommendation system using restaurant data. The system recommends restaurants that are similar to a user’s preferences or similar to a selected restaurant.
"""

# Import Libraries
import numpy as np
import pandas as pd
from sklearn.preprocessing import OneHotEncoder
from sklearn.metrics.pairwise import cosine_similarity

"""### **2. Objective**

The main objectives of this project are:

* To preprocess a restaurant dataset
* To encode categorical features
* To apply content-based filtering
* To recommend restaurants based on similarity
* To validate the recommendation results
"""

# Load Dataset
r_data = pd.read_csv("/content/Dataset.csv")
r_data.head(3)

"""### **3. Dataset Description**

The dataset contains the following important columns:

* Restaurant Name – Name of the restaurant
* Cuisines – Types of food served
* Price range – Cost category of the restaurant
* Aggregate rating – Overall customer rating

These features are used to calculate similarity between restaurants.

### **4. Methodology**

**4.1 Data Preprocessing**

* Missing values are handled to ensure data consistency.
* Only relevant features are selected for recommendation.
"""

# Handle Missing Values
r_data["Cuisines"]=r_data["Cuisines"].fillna("No Cuisine")
r_data["Price range"] = r_data["Price range"].fillna(r_data["Price range"].median())
r_data["Aggregate rating"] = r_data["Aggregate rating"].fillna(r_data["Aggregate rating"].mean())
r_data["Votes"] = r_data["Votes"].fillna(r_data["Votes"].mean())

# Select features
features = r_data[["Cuisines", "Price range", "Aggregate rating", "Votes"]]

"""**4.2 Feature Encoding**

* The Cuisines column is categorical.
* One-Hot Encoding is used to convert cuisine types into numerical values.
"""

# Encode Categorical Variable
encoder = OneHotEncoder(sparse_output= False)
cuisine_encoded = encoder.fit_transform(features[["Cuisines"]])

# Convert Dataframe of encode feature
cuisine_encoded_data = pd.DataFrame(cuisine_encoded, columns = encoder.get_feature_names_out(["Cuisines"]))

# Final Feature Matrix
feature_matrix = pd.concat([cuisine_encoded_data, features[["Price range","Aggregate rating"]]], axis=1)
feature_matrix.head(5)

"""**4.3 Similarity Calculation**

* Cosine similarity is applied to measure similarity between restaurants.
* Restaurants with higher similarity scores are considered more relevant.
"""

# Compute Cosine Similarity
similarity_matrix = cosine_similarity(feature_matrix)

"""**4.4 Recommendation Strategy**

Two recommendation approaches are implemented:

* Restaurant-based recommendation
* User preference-based recommendation

**1. Restaurance based Recommendation**
"""

def recommend_restaurant(restaurant_name, top_n=2):

    index = r_data[r_data["Restaurant Name"] == restaurant_name].index[0]

    scores = list(enumerate(similarity_matrix[index]))
    scores.sort(key=lambda x: x[1], reverse=True)

    top_matches = scores[1:top_n + 1]

    return [
        r_data.iloc[i[0]]["Restaurant Name"]
        for i in top_matches
    ]


recommend_restaurant("Le Petit Souffle")

"""**Validation of Results**

The correctness of the recommendation is validated by:

* Comparing the similarity scores
* Manually verifying cuisine, price range, and rating
* Ensuring the recommended restaurant has the highest similarity value

Restaurant recommendations vary depending on user preferences and input

**2. User Preference Input**
"""

user_input = {
    "Cuisines": "Seafood",
    "Price range": 4,
    "Aggregate rating" : 4.0
}

# Encode User preference
user_data = pd.DataFrame({"Cuisines": [user_input["Cuisines"]]})

user_cuisine_encoded = encoder.transform(user_data)

# User Feature vector
# Add the mean of 'Votes' to the user_feature_vector to match the dimensions of feature_matrix
user_feature_vector = np.concatenate([user_cuisine_encoded[0],[user_input["Price range"], user_input["Aggregate rating"]]]).reshape(1,-1)

# Final Recommendation
user_similarity = cosine_similarity(user_feature_vector, feature_matrix)

best_match_index = user_similarity.argmax()

print("Recommended Restaurant Based on (Cuisines,Price Range,Aggregate rating):", r_data.iloc[best_match_index]["Restaurant Name"])

# View recommended restaurant details
print("\n Details of the Restaurant:\n", r_data.iloc[best_match_index])

"""### **Conclusion**

This project successfully demonstrates a content-based restaurant recommendation system. The system provides accurate and explainable recommendations without requiring user history. It can be extended further using location data, user reviews, or advanced text-based similarity techniques.
"""

